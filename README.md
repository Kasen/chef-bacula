Description
===========
Tested on Ubuntu 12.04 (should also work on Debian - please report!)

Supports File backup on a dedicated storage server with a single bacula director and multiple clients to be backed up.

Painlessly autoconfigures itself and the Jobs to be done.
Backs up daily incremental, Full weekly. (to change see usage)
Also supports installation of bacula console to observe your backup progresses.


Backup Jobs are autogenerated:
- Files
set up files attribute
- Mysql
- LDAP

bacula::server (bacula-dir)
Central backup server 

bacula::client (bacula-fd)
Used by each client to be backed up

bacula::storage (bacula-sd)
For use on storage system

bacula::bat
Used for Systems with graphic environment - installs and configures "bat" Bacula qt-console


Requirements
============

mysql and database cookbooks 
openssl for password generation

Attributes
==========

Configure the bacula user
[code]
default.rb - node['bacula']['user']
default.rb - node['bacula']['group']
[/code]
Set this to your User bacula runs on your System

==Server==

Set properties for File based backup
node['bacula']['volume_size'] = "1G"
node['bacula']['volume_max'] = 20
node['bacula']['label_format'] = "BaculaFile"

==Client==

Set files to be backed up (see Usage below)
node['bacula']['fd']['files']

==Storage==

Set up destination of File-Storage
default['bacula']['sd']['backup_dir'] = "/backup"


Usage
=====


==Backup Job generation==

To autogenerate jobs the following variables need to be set on bacula::client machine:

Mysql:
node['mysql'] && node['mysql']['server_root_password']

Ldap:
node['openldap'] && node['openldap']['slapd_type'] == "master"

Chef Server:
node['fqdn'] == "chef.#{node['domain']}"

This is an example (do not use in production) how to backup files on your filesystem:
Add them according to this:
node.set['bacula']['fd']['files'] = {
  'includes' => ['/']],
  'excludes' => [ '/dev','sys']
}


Howto change the backup cycle

To change the backup cycle make changes in templates/default/bacula-dir.conf


Todo/Ideas
==========

- Add restore jobs
- more datastores
- make attributes out of the listening port
- make mailing work

Contact
======
see metadata.rb

